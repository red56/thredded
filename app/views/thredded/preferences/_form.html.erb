<%= form_for(
        preferences,
        method: :patch,
        url:    (preferences.messageboard ? messageboard_preferences_path(preferences.messageboard) : global_preferences_path),
        html:   {
            class:                                'thredded--form thredded--notification-preferences-form',
            'data-thredded-user-preferences-form' => true
        }) do |f| %>

  <h3><%= t 'thredded.preferences.form.global_preferences_label' %></h3>
  <ul class="thredded--form-list">
    <li>
      <%= f.label :follow_topics_on_mention do %>
        <%= f.check_box :follow_topics_on_mention, 'data-thredded-bound-messageboard-pref' => 'user_preferences_form[messageboard_follow_topics_on_mention]' %>
        <%= t 'thredded.preferences.form.follow_topics_on_mention.label' %>
        <p class="thredded--form-list--hint">
          <%= t 'thredded.preferences.form.follow_topics_on_mention.hint' %>
        </p>
      <% end %>
    </li>
    <li>
      <label><%= t 'thredded.preferences.form.notifications_for_followed_topics.label' %></label>
      <!--<p class="thredded&#45;&#45;form-list&#45;&#45;hint">-->
        <!--<%= t 'thredded.preferences.form.notifications_for_followed_topics.hint' %>-->
      <!--</p>-->
      <%= f.fields_for :notifications_for_followed_topics do |fn| %>
        <%- Thredded.notifiers.each do |notifier| %>
          <%= fn.label notifier.key do %>
            <%= fn.check_box notifier.key, checked: f.object.notifications_for_followed_topics[notifier.key] ?
                "checked" : false, 'data-thredded-bound-messageboard-pref' =>
                "user_preferences_form[messageboard_notifications_for_followed_topics][#{notifier.key}]" %>
            <%= t(notifier.i18n_key) %>
          <% end %>
        <%- end %>
      <%- end %>
    </li>
    <li>
      <label><%= t 'thredded.preferences.form.notifications_for_private_topics.label' %></label>
      <!--<p class="thredded&#45;&#45;form-list&#45;&#45;hint">-->
        <!--<%= t 'thredded.preferences.form.notifications_for_private_topics.hint' %>-->
      <!--</p>-->
      <%= f.fields_for :notifications_for_private_topics do |fn| %>
        <%- Thredded.notifiers.each do |notifier| %>
          <%= fn.label notifier.key do %>
            <%= fn.check_box notifier.key, checked: f.object.notifications_for_private_topics[notifier.key] ? "checked" : false %>
            <%= t(notifier.i18n_key)
              # i18n-tasks-use t("thredded.email_notifier.by_email")
            %>
          <% end %>
        <% end %>
      <% end %>
    </li>
  </ul>
  <% if preferences.messageboard %>
    <h3>
      <%= t 'thredded.preferences.form.messageboard_preferences_label_html', messageboard: messageboard.name %>
    </h3>
    <ul class="thredded--form-list" data-thredded-user-preferences-form-messageboard-fields>
      <li>
        <%= f.label :messageboard_follow_topics_on_mention do %>
          <%= f.check_box :messageboard_follow_topics_on_mention %>
          <%= t 'thredded.preferences.form.messageboard_follow_topics_on_mention.label' %>
          <p class="thredded--form-list--hint">
            <%= t 'thredded.preferences.form.messageboard_follow_topics_on_mention.hint' %>
          </p>
        <% end %>
      </li>
      <li>
        <label><%= t 'thredded.preferences.form.messageboard_notifications_for_followed_topics.label' %></label>
        <!--<p class="thredded&#45;&#45;form-list&#45;&#45;hint">-->
          <!--<%= t 'thredded.preferences.form.messageboard_notifications_for_followed_topics.hint' %>-->
        <!--</p>-->
        <%= f.fields_for :messageboard_notifications_for_followed_topics  do |fn| %>
          <%- Thredded.notifiers.each do |notifier| %>
            <%= fn.label notifier.key do %>
              <%= fn.check_box notifier.key, checked: f.object.messageboard_notifications_for_followed_topics[notifier.key] ? "checked" : false %>
              <%= t(notifier.i18n_key) %>
            <% end %>
          <% end %>
        <%- end %>
      </li>
    </ul>
  <% end %>
  <button type="submit" class="thredded--form--submit">
    <%= t 'thredded.preferences.form.submit_btn' %>
  </button>
<% end %>
